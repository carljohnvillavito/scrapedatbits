<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ScrapeDatBits</title>
    <!-- Tailwind CSS for styling -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Icons -->
    <script src="https://unpkg.com/lucide@latest"></script>
    <style>
        /* Custom Scrollbar for the stunning look */
        ::-webkit-scrollbar { width: 8px; height: 8px; }
        ::-webkit-scrollbar-track { background: #111827; }
        ::-webkit-scrollbar-thumb { background: #374151; border-radius: 4px; }
        ::-webkit-scrollbar-thumb:hover { background: #4b5563; }
        
        .glass-panel {
            background: rgba(17, 24, 39, 0.7);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
    </style>
</head>
<body class="bg-black text-gray-200 min-h-screen flex flex-col font-sans selection:bg-indigo-500 selection:text-white">

    <!-- Header -->
    <header class="p-6 text-center">
        <h1 class="text-4xl font-black tracking-tighter text-transparent bg-clip-text bg-gradient-to-r from-indigo-400 to-cyan-400 mb-2">
            ScrapeDatBits
        </h1>
        <p class="text-gray-500 text-sm uppercase tracking-widest">Minimalist URL Scraper</p>
    </header>

    <!-- Main Content -->
    <main class="flex-1 flex flex-col items-center w-full max-w-5xl mx-auto px-4 pb-10">
        
        <!-- Input Section -->
        <div class="w-full relative group z-10">
            <div class="absolute -inset-0.5 bg-gradient-to-r from-indigo-500 to-cyan-500 rounded-lg blur opacity-30 group-hover:opacity-75 transition duration-200"></div>
            <div class="relative flex items-center bg-gray-900 rounded-lg">
                <input type="text" id="urlInput" placeholder="Enter site url (e.g. example.com)" 
                    class="w-full bg-transparent border-none outline-none text-white px-5 py-4 placeholder-gray-600"
                    onkeydown="if(event.key === 'Enter') scrapeSite()">
                <button onclick="scrapeSite()" class="px-6 py-2 m-2 bg-gray-800 hover:bg-gray-700 text-white rounded-md transition border border-gray-700 font-medium">
                    Scrape
                </button>
            </div>
        </div>

        <!-- Toolbar (Hidden initially) -->
        <div id="toolbar" class="w-full mt-6 flex justify-between items-center opacity-0 transition-opacity duration-300 pointer-events-none">
            <span class="text-xs text-gray-500 font-mono" id="statusText">Ready</span>
            <div class="flex gap-2">
                <button onclick="copyToClipboard()" class="flex items-center gap-2 px-3 py-1.5 text-xs bg-gray-800 hover:bg-gray-700 rounded border border-gray-700 transition">
                    <i data-lucide="copy" class="w-3 h-3"></i> Copy
                </button>
                <button onclick="downloadFile('html')" class="flex items-center gap-2 px-3 py-1.5 text-xs bg-gray-800 hover:bg-gray-700 rounded border border-gray-700 transition">
                    <i data-lucide="file-code" class="w-3 h-3"></i> .HTML
                </button>
                <button onclick="downloadFile('txt')" class="flex items-center gap-2 px-3 py-1.5 text-xs bg-gray-800 hover:bg-gray-700 rounded border border-gray-700 transition">
                    <i data-lucide="file-text" class="w-3 h-3"></i> .TXT
                </button>
            </div>
        </div>

        <!-- Output View -->
        <div class="w-full flex-1 mt-2 relative rounded-lg overflow-hidden glass-panel min-h-[500px] flex flex-col">
            <div class="absolute top-0 left-0 w-full h-8 bg-gray-900/80 border-b border-white/5 flex items-center px-4 gap-2">
                <div class="w-2.5 h-2.5 rounded-full bg-red-500/50"></div>
                <div class="w-2.5 h-2.5 rounded-full bg-yellow-500/50"></div>
                <div class="w-2.5 h-2.5 rounded-full bg-green-500/50"></div>
            </div>
            <textarea id="outputArea" readonly 
                class="w-full h-full bg-transparent text-xs sm:text-sm font-mono text-green-400 p-4 pt-10 outline-none resize-none"
                placeholder="// Scraped content will appear here..."></textarea>
        </div>

    </main>

    <!-- Logic -->
    <script>
        // Initialize Icons
        lucide.createIcons();

        async function scrapeSite() {
            const url = document.getElementById('urlInput').value;
            const output = document.getElementById('outputArea');
            const toolbar = document.getElementById('toolbar');
            const status = document.getElementById('statusText');

            if (!url) return;

            // UI Loading State
            output.value = "Fetching data bytes...";
            status.innerText = "Requesting...";
            toolbar.classList.remove('opacity-0', 'pointer-events-none');

            try {
                // Call Internal API
                const response = await fetch(`/api/scrape?site=${encodeURIComponent(url)}`);
                const data = await response.text();

                if (response.ok) {
                    output.value = data;
                    status.innerText = `Success (${data.length} bytes)`;
                    status.classList.add('text-green-500');
                } else {
                    output.value = `Error: ${data}`;
                    status.innerText = "Failed";
                    status.classList.add('text-red-500');
                }
            } catch (err) {
                output.value = "Network Error: Could not connect to server.";
            }
        }

        function copyToClipboard() {
            const content = document.getElementById('outputArea');
            content.select();
            document.execCommand('copy');
            
            const status = document.getElementById('statusText');
            const originalText = status.innerText;
            status.innerText = "Copied to clipboard!";
            setTimeout(() => status.innerText = originalText, 2000);
        }

        function downloadFile(type) {
            const content = document.getElementById('outputArea').value;
            if(!content) return;

            const blob = new Blob([content], { type: type === 'html' ? 'text/html' : 'text/plain' });
            const anchor = document.createElement('a');
            
            anchor.href = URL.createObjectURL(blob);
            anchor.download = `scraped_bits.${type}`;
            document.body.appendChild(anchor);
            anchor.click();
            document.body.removeChild(anchor);
        }
    </script>
</body>
</html>
