<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ScrapeDatBits | Dev Tools</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    <style>
        /* Modern Scrollbar */
        ::-webkit-scrollbar { width: 6px; height: 6px; }
        ::-webkit-scrollbar-track { background: #0f1115; }
        ::-webkit-scrollbar-thumb { background: #334155; border-radius: 3px; }
        ::-webkit-scrollbar-thumb:hover { background: #475569; }
        
        .glass-panel {
            background: rgba(17, 24, 39, 0.7);
            backdrop-filter: blur(16px);
            border: 1px solid rgba(255, 255, 255, 0.08);
            box-shadow: 0 4px 30px rgba(0, 0, 0, 0.4);
        }

        .code-block {
            background: #0f1115;
            border: 1px solid #1f2937;
            font-family: 'Menlo', 'Monaco', 'Courier New', monospace;
        }
        
        /* Tab Transitions */
        .tab-content { display: none; opacity: 0; transition: opacity 0.3s ease; }
        .tab-content.active { display: flex; opacity: 1; }
        
        .nav-btn.active {
            background: rgba(34, 211, 238, 0.1);
            color: #22d3ee;
            border-color: rgba(34, 211, 238, 0.4);
        }
    </style>
</head>
<body class="bg-[#050505] text-gray-300 min-h-screen flex flex-col font-sans selection:bg-cyan-500/30 selection:text-cyan-200">

    <!-- Navbar -->
    <nav class="w-full border-b border-white/5 bg-[#0a0a0a]/80 backdrop-blur-md sticky top-0 z-50">
        <div class="max-w-6xl mx-auto px-4 h-16 flex items-center justify-between">
            <div class="flex items-center gap-2">
                <div class="w-2 h-2 rounded-full bg-cyan-400 shadow-[0_0_10px_rgba(34,211,238,0.5)]"></div>
                <h1 class="text-xl font-bold tracking-tight text-white">ScrapeDatBits</h1>
            </div>
            
            <div class="flex gap-2">
                <button onclick="switchTab('scraper')" id="btn-scraper" class="nav-btn active flex items-center gap-2 px-4 py-2 text-xs font-bold uppercase tracking-wider rounded-md border border-transparent hover:border-white/10 transition">
                    <i data-lucide="terminal-square" class="w-4 h-4"></i> Tool
                </button>
                <button onclick="switchTab('docs')" id="btn-docs" class="nav-btn flex items-center gap-2 px-4 py-2 text-xs font-bold uppercase tracking-wider rounded-md border border-transparent hover:border-white/10 transition">
                    <i data-lucide="book-open" class="w-4 h-4"></i> Docs
                </button>
            </div>
        </div>
    </nav>

    <!-- MAIN CONTENT CONTAINER -->
    <main class="flex-1 w-full max-w-6xl mx-auto px-4 py-8 relative">

        <!-- ==================== TAB 1: SCRAPER TOOL ==================== -->
        <div id="tab-scraper" class="tab-content active flex-col items-center w-full">
            
            <!-- Hero Text -->
            <div class="text-center mb-8">
                <h2 class="text-4xl md:text-5xl font-black text-transparent bg-clip-text bg-gradient-to-r from-indigo-400 via-cyan-400 to-emerald-400 drop-shadow-2xl">
                    Extract The Web.
                </h2>
                <p class="mt-2 text-gray-500 text-sm font-mono">Serverless • Stealth • Multi-Format</p>
            </div>

            <!-- Input Bar -->
            <div class="w-full max-w-3xl relative group mb-6 z-10">
                <div class="absolute -inset-0.5 bg-gradient-to-r from-cyan-500 to-indigo-500 rounded-lg blur opacity-20 group-hover:opacity-50 transition duration-500"></div>
                <div class="relative flex flex-col sm:flex-row bg-[#0f1115] rounded-lg border border-white/10 shadow-2xl overflow-hidden">
                    <input type="text" id="urlInput" placeholder="https://example.com" 
                        class="w-full bg-transparent border-none outline-none text-white px-5 py-4 font-mono text-sm placeholder-gray-600"
                        onkeydown="if(event.key === 'Enter') scrapeSite()">
                    <button onclick="scrapeSite()" class="px-8 py-4 sm:py-0 bg-white/5 hover:bg-white/10 text-cyan-400 font-bold uppercase text-xs tracking-widest border-t sm:border-t-0 sm:border-l border-white/10 transition active:bg-cyan-500/10">
                        Execute
                    </button>
                </div>
            </div>

            <!-- Toolbar -->
            <div id="toolbar" class="w-full max-w-3xl flex justify-between items-center mb-4 opacity-50 transition-opacity pointer-events-none">
                <span id="statusText" class="text-xs font-mono text-gray-500">Ready for input</span>
                <div class="flex gap-2 pointer-events-auto">
                    <button onclick="copyToClipboard()" class="p-2 bg-[#0f1115] border border-white/10 rounded hover:border-cyan-500/50 hover:text-cyan-400 transition" title="Copy to Clipboard">
                        <i data-lucide="copy" class="w-4 h-4"></i>
                    </button>
                    <!-- Direct Download Links via API -->
                    <button onclick="downloadDirect('html')" class="flex items-center gap-2 px-3 py-1.5 text-xs font-mono bg-[#0f1115] border border-white/10 rounded hover:border-cyan-500/50 hover:text-cyan-400 transition">
                        <i data-lucide="download" class="w-3 h-3"></i> .HTML
                    </button>
                    <button onclick="downloadDirect('txt')" class="flex items-center gap-2 px-3 py-1.5 text-xs font-mono bg-[#0f1115] border border-white/10 rounded hover:border-cyan-500/50 hover:text-cyan-400 transition">
                        <i data-lucide="file-text" class="w-3 h-3"></i> .TXT
                    </button>
                </div>
            </div>

            <!-- Editor Window -->
            <div class="w-full h-[60vh] glass-panel rounded-xl flex flex-col overflow-hidden relative group">
                <div class="h-10 bg-[#0a0a0a] border-b border-white/5 flex items-center px-4 justify-between shrink-0">
                    <div class="flex gap-2">
                        <div class="w-2.5 h-2.5 rounded-full bg-red-500/50"></div>
                        <div class="w-2.5 h-2.5 rounded-full bg-yellow-500/50"></div>
                        <div class="w-2.5 h-2.5 rounded-full bg-green-500/50"></div>
                    </div>
                    <span id="windowTitle" class="text-[10px] uppercase tracking-widest text-gray-600 font-mono">source_view</span>
                </div>
                <textarea id="outputArea" readonly spellcheck="false" 
                    class="flex-1 bg-transparent p-4 font-mono text-xs md:text-sm text-gray-300 outline-none resize-none leading-relaxed"></textarea>
                
                <!-- Loading Overlay -->
                <div id="loadingOverlay" class="absolute inset-0 bg-[#050505]/80 backdrop-blur-sm z-20 hidden flex-col items-center justify-center">
                    <div class="w-12 h-12 border-2 border-cyan-500/20 border-t-cyan-400 rounded-full animate-spin mb-4"></div>
                    <p class="text-cyan-400 font-mono text-xs animate-pulse">CONNECTING TO PROXY MESH...</p>
                </div>
            </div>
        </div>

        <!-- ==================== TAB 2: DOCUMENTATION ==================== -->
        <div id="tab-docs" class="tab-content flex-col w-full max-w-4xl mx-auto">
            
            <div class="mb-10">
                <h2 class="text-3xl font-bold text-white mb-4">API Reference</h2>
                <p class="text-gray-400 leading-relaxed">
                    ScrapeDatBits provides a powerful REST API to extract HTML content from any public URL. 
                    It handles proxy rotation, user-agent spoofing, and dynamic rendering (Puppeteer) automatically.
                </p>
            </div>

            <!-- Endpoint -->
            <div class="glass-panel rounded-xl p-6 mb-8">
                <div class="flex items-center gap-3 mb-4">
                    <span class="bg-cyan-500/10 text-cyan-400 px-2 py-1 rounded text-xs font-bold border border-cyan-500/20">GET</span>
                    <code class="text-sm font-mono text-white">/api/scrape</code>
                </div>
                <p class="text-sm text-gray-400 mb-4">The primary endpoint to fetch site data.</p>
                
                <!-- Params Table -->
                <div class="overflow-x-auto">
                    <table class="w-full text-left text-sm">
                        <thead class="text-gray-500 border-b border-white/10">
                            <tr>
                                <th class="pb-3 font-normal uppercase tracking-wider text-xs">Parameter</th>
                                <th class="pb-3 font-normal uppercase tracking-wider text-xs">Type</th>
                                <th class="pb-3 font-normal uppercase tracking-wider text-xs">Required</th>
                                <th class="pb-3 font-normal uppercase tracking-wider text-xs">Description</th>
                            </tr>
                        </thead>
                        <tbody class="text-gray-300 font-mono text-xs">
                            <tr class="border-b border-white/5">
                                <td class="py-3 text-cyan-400">site</td>
                                <td class="py-3">string</td>
                                <td class="py-3 text-emerald-400">Yes</td>
                                <td class="py-3 text-gray-400">The target URL (e.g. facebook.com)</td>
                            </tr>
                            <tr class="border-b border-white/5">
                                <td class="py-3 text-cyan-400">mode</td>
                                <td class="py-3">string</td>
                                <td class="py-3 text-gray-600">No</td>
                                <td class="py-3 text-gray-400">Set to <span class="text-yellow-400">dynamic</span> to force Puppeteer (slower, better for SPAs).</td>
                            </tr>
                            <tr>
                                <td class="py-3 text-cyan-400">download</td>
                                <td class="py-3">string</td>
                                <td class="py-3 text-gray-600">No</td>
                                <td class="py-3 text-gray-400">
                                    Set to <span class="text-yellow-400">html</span> or <span class="text-yellow-400">txt</span> to trigger a file download.
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Example Usage -->
            <div class="mb-8">
                <h3 class="text-lg font-bold text-white mb-3">Example Request</h3>
                <div class="code-block rounded-lg p-4 overflow-x-auto relative group">
                    <button onclick="copyCode(this)" class="absolute top-2 right-2 p-1.5 bg-white/5 rounded hover:bg-white/10 transition opacity-0 group-hover:opacity-100">
                        <i data-lucide="copy" class="w-3 h-3 text-gray-400"></i>
                    </button>
                    <pre class="text-sm text-green-400">http://localhost:3000/api/scrape?site=example.com&download=html</pre>
                </div>
            </div>

            <!-- Example Response -->
            <div class="mb-8">
                <h3 class="text-lg font-bold text-white mb-3">Response</h3>
                <p class="text-sm text-gray-400 mb-2">Returns raw HTML string or a file attachment.</p>
                <div class="code-block rounded-lg p-4 overflow-x-auto">
<pre class="text-xs text-gray-300 leading-relaxed">
<span class="text-blue-400">&lt;!DOCTYPE html&gt;</span>
<span class="text-blue-400">&lt;html&gt;</span>
  <span class="text-blue-400">&lt;head&gt;</span>
    <span class="text-blue-400">&lt;title&gt;</span>Example Domain<span class="text-blue-400">&lt;/title&gt;</span>
  <span class="text-blue-400">&lt;/head&gt;</span>
  <span class="text-blue-400">&lt;body&gt;</span>
    ...
</pre>
                </div>
            </div>

        </div>

    </main>

    <!-- DONATION FOOTER -->
    <footer class="w-full py-10 mt-auto border-t border-white/5 bg-[#080808] relative">
        <div class="absolute inset-x-0 top-0 h-px bg-gradient-to-r from-transparent via-cyan-500/20 to-transparent"></div>
        <div class="max-w-xl mx-auto px-4 flex flex-col items-center text-center gap-5">
            <div>
                <h3 class="text-white font-bold text-lg mb-1">Fuel the Project</h3>
                <p class="text-gray-500 text-xs">Servers aren't free, but your support keeps them running.</p>
            </div>
            
            <a href="https://sociabuzz.com/carljohnvillavito" target="_blank" 
               class="group relative flex items-center gap-3 px-6 py-3 bg-[#0f1115] rounded-full border border-yellow-500/20 hover:border-yellow-500/50 transition-all duration-300 hover:scale-105 hover:shadow-[0_0_20px_rgba(234,179,8,0.2)]">
                
                <!-- SociaBuzz Logo / Icon Representation -->
                <div class="w-8 h-8 rounded-full bg-gradient-to-br from-yellow-400 to-yellow-600 flex items-center justify-center text-black shadow-lg">
                    <i data-lucide="heart" class="w-4 h-4 fill-black"></i>
                </div>
                
                <div class="flex flex-col items-start">
                    <span class="text-[10px] text-gray-400 uppercase tracking-widest font-bold">Donate via</span>
                    <span class="text-sm font-bold text-white group-hover:text-yellow-400 transition-colors">SociaBuzz</span>
                </div>

                <i data-lucide="external-link" class="w-4 h-4 text-gray-600 group-hover:text-white transition-colors ml-2"></i>
            </a>

            <p class="text-[10px] text-gray-700 font-mono mt-4">© 2025 ScrapeDatBits. All systems operational.</p>
        </div>
    </footer>

    <!-- JS Logic -->
    <script>
        lucide.createIcons();
        let currentUrl = "";

        // Tab Switching Logic
        function switchTab(tabName) {
            document.querySelectorAll('.tab-content').forEach(el => el.classList.remove('active'));
            document.querySelectorAll('.nav-btn').forEach(el => el.classList.remove('active'));
            
            document.getElementById(`tab-${tabName}`).classList.add('active');
            document.getElementById(`btn-${tabName}`).classList.add('active');
        }

        async function scrapeSite() {
            const urlInput = document.getElementById('urlInput');
            const output = document.getElementById('outputArea');
            const toolbar = document.getElementById('toolbar');
            const status = document.getElementById('statusText');
            const loading = document.getElementById('loadingOverlay');
            
            currentUrl = urlInput.value;
            if (!currentUrl) { urlInput.focus(); return; }

            // UI State: Loading
            loading.style.display = 'flex';
            toolbar.style.opacity = '0.5';
            
            try {
                // Fetch for View only (no download param)
                const response = await fetch(`/api/scrape?site=${encodeURIComponent(currentUrl)}`);
                const data = await response.text();

                if (response.ok) {
                    output.value = data;
                    status.innerText = `Success (${formatBytes(new TextEncoder().encode(data).length)})`;
                    status.className = "text-xs font-mono text-emerald-400";
                    toolbar.style.opacity = '1';
                    toolbar.style.pointerEvents = 'auto';
                } else {
                    output.value = data; // Show error log
                    status.innerText = "Request Failed";
                    status.className = "text-xs font-mono text-red-500";
                }
            } catch (err) {
                output.value = "Network Error: Server unreachable.";
                status.innerText = "Error";
            } finally {
                loading.style.display = 'none';
            }
        }

        // --- Direct Download Function ---
        function downloadDirect(format) {
            if(!currentUrl) return;
            // Create a temporary link to trigger the API download
            const link = document.createElement('a');
            link.href = `/api/scrape?site=${encodeURIComponent(currentUrl)}&download=${format}`;
            link.target = '_blank'; // Opens in new tab to handle download
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
        }

        function copyToClipboard() {
            const content = document.getElementById('outputArea');
            content.select();
            document.execCommand('copy');
            const status = document.getElementById('statusText');
            const original = status.innerText;
            status.innerText = "Copied!";
            setTimeout(() => status.innerText = original, 1500);
        }

        function copyCode(btn) {
            const code = btn.nextElementSibling.innerText;
            navigator.clipboard.writeText(code);
            // Visual feedback could be added here
        }

        function formatBytes(bytes, decimals = 2) {
            if (!+bytes) return '0 B';
            const k = 1024;
            const sizes = ['B', 'KB', 'MB', 'GB'];
            const i = Math.floor(Math.log(bytes) / Math.log(k));
            return `${parseFloat((bytes / Math.pow(k, i)).toFixed(decimals))} ${sizes[i]}`;
        }
    </script>
</body>
</html>
